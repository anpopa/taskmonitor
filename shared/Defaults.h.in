/*-
 * SPDX-License-Identifier: MIT
 *-
 * @date      2021-2022
 * @author    Alin Popa <alin.popa@fxdata.ro>
 * @copyright MIT
 * @brief     Defaults class
 * @details   Declare defaults values for application
 *-
 */

#pragma once

#include <map>
#include <string>

namespace tkm::monitor
{

class Defaults
{
public:
  enum class Default {
    Version,
    ConfPath,
    ContainersPath,
    RuntimeDirectory,
    RxBufferSize,
    TxBufferSize,
    MsgBufferSize,
    EnableTCPServer,
    EnableUDSServer,
    FastLaneInterval,
    PaceLaneInterval,
    SlowLaneInterval,
    ReadProcAtInit,
    TCPServerAddress,
    TCPServerPort,
    TCPServerStartIfPath,
    TCPServerStartOnSignal,
    UDSServerSocketPath,
    UDSServerStartIfPath,
    UDSServerStartOnSignal,
  };

  enum class Val { True, False, ProcAcct, ProcInfo };

  Defaults()
  {
    m_table.insert(std::pair<Default, std::string>(Default::Version, "@GIT_SHA1@"));
    m_table.insert(std::pair<Default, std::string>(Default::ConfPath, "@TKM_CONFIG_FILE@"));
    m_table.insert(std::pair<Default, std::string>(Default::ContainersPath, "/var/lib/lxc"));
    m_table.insert(std::pair<Default, std::string>(Default::RuntimeDirectory, "/run/taskmonitor"));
    m_table.insert(std::pair<Default, std::string>(Default::RxBufferSize, "1048576"));
    m_table.insert(std::pair<Default, std::string>(Default::TxBufferSize, "1048576"));
    m_table.insert(std::pair<Default, std::string>(Default::MsgBufferSize, "1048576"));
    m_table.insert(std::pair<Default, std::string>(Default::FastLaneInterval, "1000000"));
    m_table.insert(std::pair<Default, std::string>(Default::PaceLaneInterval, "5000000"));
    m_table.insert(std::pair<Default, std::string>(Default::SlowLaneInterval, "10000000"));
    m_table.insert(std::pair<Default, std::string>(Default::ReadProcAtInit, "true"));
    m_table.insert(std::pair<Default, std::string>(Default::EnableTCPServer, "true"));
    m_table.insert(std::pair<Default, std::string>(Default::EnableUDSServer, "false"));
    m_table.insert(std::pair<Default, std::string>(Default::TCPServerAddress, "localhost"));
    m_table.insert(std::pair<Default, std::string>(Default::TCPServerPort, "3357"));
    m_table.insert(std::pair<Default, std::string>(Default::TCPServerStartIfPath, "none"));
    m_table.insert(std::pair<Default, std::string>(Default::UDSServerSocketPath,
                                                   "/run/taskmonitor/taskmonitor.sock"));
    m_table.insert(std::pair<Default, std::string>(Default::UDSServerStartIfPath, "none"));

    m_vals.insert(std::pair<Val, std::string>(Val::True, "True"));
    m_vals.insert(std::pair<Val, std::string>(Val::False, "False"));
    m_vals.insert(std::pair<Val, std::string>(Val::ProcAcct, "ProcAcct"));
    m_vals.insert(std::pair<Val, std::string>(Val::ProcInfo, "ProcInfo"));
  }

  auto getFor(Default key) -> std::string & { return m_table.at(key); }
  auto valFor(Val key) -> std::string & { return m_vals.at(key); }

private:
  std::map<Default, std::string> m_table;
  std::map<Val, std::string> m_vals;
};

static Defaults tkmDefaults{};

} // namespace tkm::monitor
